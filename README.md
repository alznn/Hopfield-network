# Hopfield-network
### GUI.py：
主要為設定圖形化介面，並將使用者雜訊訊號的機率、想要記憶的資料集，已集想要回想的輸入矩陣，將使用者自定義各項參數，呼叫 kernel.py 中進行訓練、記憶與回想，並將結果呈現給使用者。圖形化介面設計如下圖所顯示，介面分成五個區域，左半部分呈現原始資料、受雜訊干擾後的圖片、原始資料回想結果與受雜訊干擾資料的回想結果，測試資料集的視覺化結果。
第一次執行時因未選取任何資料及進行記憶與回想，故圖片部分呈現空白。

介面右半部區域為使用者輸入使用，使用者可以在此輸入雜訊出現的機率、想要看的資料集以及相對應的輸入矩陣，點選「 train 」按鈕進行訓練，訓練完後點選「 show result」觀看訓練與回想結果。須注意選擇非雜訊訊號，若先前未經過回想的圖片不會出現在圖形化介面中，因此若不含雜訊訊號的回想，就不會看到含有雜訊訊號的回想圖片，反之亦然，如下兩圖所示
 
 
在 GUI.py 程式碼中，為方便參數的傳遞，將所有介面相關元件，以及元件觸發事件包在 class skin 中。並定義 train_model() 函式，利用 getGUI() API 傳遞使用者設定條件至 kernel.py，進行模型的訓練及回想，並將結果繪製成圖片儲存。同時定義 change 函示，更新回想結果於介面中。

本作業為因應不同資料集有不同的圖形輸入，多加一組 get_pattern()，使圖形化見面可根據不同資料集，提供使用者相對應的輸入矩陣，傳遞到 kernel.py 中進行回想。

###	Kernel.py 
模型核心部分，包含建立異步回想、資料處理、Hopfield 網路各項運算所需網路及繪圖函式等功能。
參數簡介：
- X：training dataset 轉換成矩陣
- Y：testing dataset 轉換成矩陣
- weight： Hopfield 的網路權重矩陣，根據公式所求得。
- theta：根據下圖公式所求的參數向量
- isNoise：記錄使用者是否加噪音
- rate：記錄使用者噪音發生的機率
- flag：紀錄現在想要回想的矩陣屬於哪一個資料集
函式數簡介：

- addNoise()：若需要加入噪音干擾則呼叫此函式，函式會遍歷指定輸入矩陣的每一個點資料，以 Basic dataset 舉例，會便利 9*12 個點，每個點都要隨機亂數產生介於 0 到 1 之間的值，若是該隨機亂數小於使用者輸入的噪音干擾比例，則將該筆資料點乘以-1，改變原本的訊號值，迴圈結束後，將最後受干擾的新訊號回傳。
- transport()：Hopfile 內部公式，並回傳到最終結果給 weight_sum 變數。
- getTheta()：根據 Hopfield 公式，並回傳計算後向量給 theta 。
- Hopfield_energy_function ()：計算 Hopfield 網路的能量函數，並回傳到 asy_recall() 函式中。
- asy_recall ()：採用非同步模式進行計算，使 Hopfield 網路收斂到穩定狀態。 
- draw_picture()：將指定資料集進行資料視覺化並儲存
- RecallPicture()：針對使用者指定輸入矩陣進行回想。
- getGUIg()：獲取使用者指定數據進行網路訓練與回想。

### 實驗結果
本作業的實驗結果，Basic dataset 不論是否有加入噪音均可以正確回想，若噪音比例低於 0.50，則有 99% 的機率可以正確回想。Bonus 部分，特定幾個較為複雜的輸入矩陣，在回想上都會有失真的情況，但是針對可以正確回想的圖片，即使加入噪音，且噪音比例低於 0.50，都有 98% 以上的正確率。

